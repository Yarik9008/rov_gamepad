# ROV Gamepad Control System

–°–∏—Å—Ç–µ–º–∞ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è ROV (Remotely Operated Vehicle) —á–µ—Ä–µ–∑ –≥–µ–π–º–ø–∞–¥ –Ω–∞ –±–∞–∑–µ STM32F103C8T6 (BluePill).

## üìã –û–ø–∏—Å–∞–Ω–∏–µ —Å–∏—Å—Ç–µ–º—ã

–°–∏—Å—Ç–µ–º–∞ –ø—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω–∞ –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø–æ–¥–≤–æ–¥–Ω—ã–º —Ä–æ–±–æ—Ç–æ–º —á–µ—Ä–µ–∑ –≥–µ–π–º–ø–∞–¥ —Å –¥–≤—É–º—è –¥–∂–æ–π—Å—Ç–∏–∫–∞–º–∏ –∏ –∫–Ω–æ–ø–∫–∞–º–∏. –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –¥–≤–∏–∂–µ–Ω–∏–µ–º, –∫–∞–º–µ—Ä–æ–π, –º–∞–Ω–∏–ø—É–ª—è—Ç–æ—Ä–æ–º –∏ –æ—Å–≤–µ—â–µ–Ω–∏–µ–º.

## üîß –ê–ø–ø–∞—Ä–∞—Ç–Ω–∞—è —á–∞—Å—Ç—å

### –ú–∏–∫—Ä–æ–∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä
- **STM32F103C8T6** (BluePill)
- **–ß–∞—Å—Ç–æ—Ç–∞:** 72 –ú–ì—Ü
- **Flash:** 64 –ö–ë
- **RAM:** 20 –ö–ë

### –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –¥–∂–æ–π—Å—Ç–∏–∫–æ–≤
```
–î–∂–æ–π—Å—Ç–∏–∫ 1 (–æ—Å–Ω–æ–≤–Ω–æ–µ –¥–≤–∏–∂–µ–Ω–∏–µ):
‚îú‚îÄ‚îÄ X –æ—Å—å (PA0) ‚Üí –≤–ø–µ—Ä–µ–¥/–Ω–∞–∑–∞–¥
‚îî‚îÄ‚îÄ Y –æ—Å—å (PA1) ‚Üí –ø–æ–≤–æ—Ä–æ—Ç –≤–ª–µ–≤–æ/–≤–ø—Ä–∞–≤–æ

–î–∂–æ–π—Å—Ç–∏–∫ 2 (–≤–µ—Ä—Ç–∏–∫–∞–ª—å–Ω–æ–µ –¥–≤–∏–∂–µ–Ω–∏–µ):
‚îú‚îÄ‚îÄ X –æ—Å—å (PA2) ‚Üí –¥–≤–∏–∂–µ–Ω–∏–µ –≤–≤–µ—Ä—Ö/–≤–Ω–∏–∑
‚îî‚îÄ‚îÄ Y –æ—Å—å (PA3) ‚Üí –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è
```

### –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫–Ω–æ–ø–æ–∫
```
–ö–Ω–æ–ø–∫–∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø–æ–ª–µ–∑–Ω–æ–π –Ω–∞–≥—Ä—É–∑–∫–æ–π:
‚îú‚îÄ‚îÄ BUTTON0 (PA4) ‚Üí –ø–æ–≤–æ—Ä–æ—Ç –∫–∞–º–µ—Ä—ã –≤–ª–µ–≤–æ
‚îú‚îÄ‚îÄ BUTTON1 (PA5) ‚Üí –ø–æ–≤–æ—Ä–æ—Ç –∫–∞–º–µ—Ä—ã –≤–ø—Ä–∞–≤–æ
‚îú‚îÄ‚îÄ BUTTON2 (PA6) ‚Üí –æ—Ç–∫—Ä—ã—Ç—å –º–∞–Ω–∏–ø—É–ª—è—Ç–æ—Ä
‚îú‚îÄ‚îÄ BUTTON3 (PA7) ‚Üí –∑–∞–∫—Ä—ã—Ç—å –º–∞–Ω–∏–ø—É–ª—è—Ç–æ—Ä
‚îú‚îÄ‚îÄ BUTTON4 (PB0) ‚Üí –≤–∫–ª—é—á–∏—Ç—å –æ—Å–≤–µ—â–µ–Ω–∏–µ
‚îî‚îÄ‚îÄ BUTTON5 (PB1) ‚Üí –≤—ã–∫–ª—é—á–∏—Ç—å –æ—Å–≤–µ—â–µ–Ω–∏–µ
```

### Serial –ø–æ—Ä—Ç—ã
```
Serial1 (PA9/PA10) ‚Üí –ø–µ—Ä–µ–¥–∞—á–∞ –∫–æ–º–∞–Ω–¥ –Ω–∞ ROV
Serial2 (PB10/PB11) ‚Üí –æ—Ç–ª–∞–¥–æ—á–Ω—ã–π –≤—ã–≤–æ–¥ (115200 baud)
```

## üèóÔ∏è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –∫–æ–¥–∞

### –û—Å–Ω–æ–≤–Ω—ã–µ –º–æ–¥—É–ª–∏

#### 1. **Config.h** - –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è —Å–∏—Å—Ç–µ–º—ã
```cpp
// –ü–∏–Ω—ã –¥–∂–æ–π—Å—Ç–∏–∫–æ–≤
#define JOYSTICK1_X PA0    // –î–∂–æ–π—Å—Ç–∏–∫ 1 - X –æ—Å—å
#define JOYSTICK1_Y PA1    // –î–∂–æ–π—Å—Ç–∏–∫ 1 - Y –æ—Å—å
#define JOYSTICK2_X PA2    // –î–∂–æ–π—Å—Ç–∏–∫ 2 - X –æ—Å—å
#define JOYSTICK2_Y PA3    // –î–∂–æ–π—Å—Ç–∏–∫ 2 - Y –æ—Å—å

// –ü–∏–Ω—ã –∫–Ω–æ–ø–æ–∫
#define BUTTON0 PA4        // –ü–æ–≤–æ—Ä–æ—Ç –∫–∞–º–µ—Ä—ã –≤–ª–µ–≤–æ
#define BUTTON1 PA5        // –ü–æ–≤–æ—Ä–æ—Ç –∫–∞–º–µ—Ä—ã –≤–ø—Ä–∞–≤–æ
#define BUTTON2 PA6        // –û—Ç–∫—Ä—ã—Ç—å –º–∞–Ω–∏–ø—É–ª—è—Ç–æ—Ä
#define BUTTON3 PA7        // –ó–∞–∫—Ä—ã—Ç—å –º–∞–Ω–∏–ø—É–ª—è—Ç–æ—Ä
#define BUTTON4 PB0        // –í–∫–ª—é—á–∏—Ç—å –æ—Å–≤–µ—â–µ–Ω–∏–µ
#define BUTTON5 PB1        // –í—ã–∫–ª—é—á–∏—Ç—å –æ—Å–≤–µ—â–µ–Ω–∏–µ

// PWM –¥–∏–∞–ø–∞–∑–æ–Ω—ã
#define PWM_MIN 1000       // –ú–∏–Ω–∏–º–∞–ª—å–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ PWM
#define PWM_CENTER 1500    // –ù–µ–π—Ç—Ä–∞–ª—å–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ PWM
#define PWM_MAX 2000       // –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ PWM
```

#### 2. **JoystickModule.h** - –û–±—Ä–∞–±–æ—Ç–∫–∞ –≤–≤–æ–¥–∞
- –ß—Ç–µ–Ω–∏–µ –∞–Ω–∞–ª–æ–≥–æ–≤—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π –¥–∂–æ–π—Å—Ç–∏–∫–æ–≤ (12-bit ADC: 0-4095)
- –ö–∞–ª–∏–±—Ä–æ–≤–∫–∞ –Ω—É–ª–µ–≤—ã—Ö –ø–æ–ª–æ–∂–µ–Ω–∏–π
- –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ —Ñ–∏–ª—å—Ç—Ä–∞ –ö–∞–ª–º–∞–Ω–∞ –¥–ª—è —Å–≥–ª–∞–∂–∏–≤–∞–Ω–∏—è (Q=25, R=20, P_init=1000)
- –û–±—Ä–∞–±–æ—Ç–∫–∞ –º–µ—Ä—Ç–≤–æ–π –∑–æ–Ω—ã (¬±25 –µ–¥–∏–Ω–∏—Ü)
- –ß—Ç–µ–Ω–∏–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è –∫–Ω–æ–ø–æ–∫ (INPUT_PULLUP)
- –ù–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö –≤ –¥–∏–∞–ø–∞–∑–æ–Ω [-1.0, 1.0]
- –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç–æ–≤ –≤–∫–ª–∞–¥–∞ –ø–æ –æ—Å—è–º

#### 3. **KinematicsModule.h** - –†–∞—Å—á–µ—Ç –∫–∏–Ω–µ–º–∞—Ç–∏–∫–∏
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–π: 3, 4, 6, 8 –º–æ—Ç–æ—Ä–æ–≤
- –†–∞—Å—á–µ—Ç PWM –∑–Ω–∞—á–µ–Ω–∏–π –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –º–æ—Ç–æ—Ä–∞
- –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ —Ä–µ–≤–µ—Ä—Å–∞ –º–æ—Ç–æ—Ä–æ–≤
- –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ PWM –≤ –±–µ–∑–æ–ø–∞—Å–Ω—ã—Ö –ø—Ä–µ–¥–µ–ª–∞—Ö

#### 4. **ROVController.h** - –û—Å–Ω–æ–≤–Ω–æ–π –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä
- –ö–æ–æ—Ä–¥–∏–Ω–∞—Ü–∏—è –≤—Å–µ—Ö –º–æ–¥—É–ª–µ–π
- –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª–µ–∑–Ω–æ–π –Ω–∞–≥—Ä—É–∑–∫–æ–π
- –§–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–æ–º–∞–Ω–¥ –¥–ª—è ROV
- –í—ã–≤–æ–¥ —Ç–µ–ª–µ–º–µ—Ç—Ä–∏–∏

## üìä –°—Ç—Ä—É–∫—Ç—É—Ä—ã –¥–∞–Ω–Ω—ã—Ö

### JoystickData - –í—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
```cpp
struct JoystickData {
    float linear_x;        // -1.0 –¥–æ 1.0 (–≤–ø–µ—Ä–µ–¥/–Ω–∞–∑–∞–¥)
    float linear_y;        // -1.0 –¥–æ 1.0 (–≤–≤–µ—Ä—Ö/–≤–Ω–∏–∑)
    float linear_z;        // -1.0 –¥–æ 1.0 (–≤–ª–µ–≤–æ/–≤–ø—Ä–∞–≤–æ)
    float rotate_y;        // -1.0 –¥–æ 1.0 (–ø–æ–≤–æ—Ä–æ—Ç)
    float rotate_x;        // 0.0 (–Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è)
    float rotate_z;        // 0.0 (–Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è)
    int servo_cam;         // -1, 0, 1 (–ø–æ–≤–æ—Ä–æ—Ç –∫–∞–º–µ—Ä—ã)
    int gripper;           // -1, 0, 1 (–º–∞–Ω–∏–ø—É–ª—è—Ç–æ—Ä)
    int led;               // 0, 1 (–æ—Å–≤–µ—â–µ–Ω–∏–µ)
    int stabilization_depth;    // 0 (–Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è)
    int stabilization_course;  // 0 (–Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è)
};
```

### ROVCommands - –í—ã—Ö–æ–¥–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã
```cpp
struct ROVCommands {
    // PWM –∑–Ω–∞—á–µ–Ω–∏—è –º–æ—Ç–æ—Ä–æ–≤ (8 –º–æ—Ç–æ—Ä–æ–≤)
    int motor0_pwm;        // –ú–æ—Ç–æ—Ä 0
    int motor1_pwm;        // –ú–æ—Ç–æ—Ä 1
    int motor2_pwm;        // –ú–æ—Ç–æ—Ä 2
    int motor3_pwm;        // –ú–æ—Ç–æ—Ä 3
    int motor4_pwm;        // –ú–æ—Ç–æ—Ä 4
    int motor5_pwm;        // –ú–æ—Ç–æ—Ä 5
    int motor6_pwm;        // –ú–æ—Ç–æ—Ä 6
    int motor7_pwm;        // –ú–æ—Ç–æ—Ä 7
    
    // –ü–æ–ª–µ–∑–Ω–∞—è –Ω–∞–≥—Ä—É–∑–∫–∞
    int camera_servo;      // –ü–æ–∑–∏—Ü–∏—è –∫–∞–º–µ—Ä—ã (1000-2000)
    int manipulator;       // –ü–æ–∑–∏—Ü–∏—è –º–∞–Ω–∏–ø—É–ª—è—Ç–æ—Ä–∞ (1000-2000)
    int light;             // –£—Ä–æ–≤–µ–Ω—å –æ—Å–≤–µ—â–µ–Ω–∏—è (0-255)
};
```

## üîÑ –ê–ª–≥–æ—Ä–∏—Ç–º —Ä–∞–±–æ—Ç—ã

### 1. –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
```cpp
void setup() {
    // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è Serial –ø–æ—Ä—Ç–æ–≤
    Serial1.begin(115200);  // –ö–æ–º–∞–Ω–¥—ã –Ω–∞ ROV
    Serial2.begin(115200);   // –û—Ç–ª–∞–¥–∫–∞
    
    // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä–∞
    rov_controller.initialize();
}
```

### 2. –û—Å–Ω–æ–≤–Ω–æ–π —Ü–∏–∫–ª
```cpp
void loop() {
    rov_controller.update();
    // –ù–µ—Ç –∑–∞–¥–µ—Ä–∂–∫–∏ - —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —á–∞—Å—Ç–æ—Ç–æ–π —á–µ—Ä–µ–∑ DATA_INTERVAL
}
```

### 3. –û–±—Ä–∞–±–æ—Ç–∫–∞ –¥–∞–Ω–Ω—ã—Ö –≤ ROVController::update()
```cpp
void update() {
    // 1. –ß—Ç–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –¥–∂–æ–π—Å—Ç–∏–∫–∞ –∏ –∫–Ω–æ–ø–æ–∫
    JoystickData joy_data = joystick.readData();
    
    // 2. –í–∞–ª–∏–¥–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö
    if (!joystick.isValidJoystickData(joy_data)) {
        return; // –ü—Ä–æ–ø—É—Å—Ç–∏—Ç—å –Ω–µ–≤–∞–ª–∏–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
    }
    
    // 3. –†–∞—Å—á–µ—Ç –∫–∏–Ω–µ–º–∞—Ç–∏–∫–∏ –¥–≤–∏–∂–µ–Ω–∏—è
    MotorPWMValues motor_pwm = kinematics.calculate(joy_data, kinematics_config);
    
    // 4. –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø–æ–ª–µ–∑–Ω–æ–π –Ω–∞–≥—Ä—É–∑–∫–∏
    updateCamera(joy_data);      // –ü–æ–≤–æ—Ä–æ—Ç –∫–∞–º–µ—Ä—ã (–∏–Ω–∫—Ä–µ–º–µ–Ω—Ç–∞–ª—å–Ω–æ–µ)
    updateManipulator(joy_data);  // –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –º–∞–Ω–∏–ø—É–ª—è—Ç–æ—Ä–æ–º (–º–≥–Ω–æ–≤–µ–Ω–Ω–æ–µ)
    updateLighting(joy_data);     // –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –æ—Å–≤–µ—â–µ–Ω–∏–µ–º (–º–≥–Ω–æ–≤–µ–Ω–Ω–æ–µ)
    
    // 5. –§–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–æ–º–∞–Ω–¥
    ROVCommands commands;
    // –ö–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ PWM –º–æ—Ç–æ—Ä–æ–≤
    commands.motor0_pwm = motor_pwm.motor0_pwm;
    // ... –æ—Å—Ç–∞–ª—å–Ω—ã–µ –º–æ—Ç–æ—Ä—ã
    // –ö–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ–ª–µ–∑–Ω–æ–π –Ω–∞–≥—Ä—É–∑–∫–∏
    commands.camera_servo = payload_state.camera_servo;
    commands.manipulator = payload_state.manipulator;
    commands.light = payload_state.light;
    
    // 6. –û—Ç–ø—Ä–∞–≤–∫–∞ –∫–æ–º–∞–Ω–¥
    outputCommands(commands);
    
    // 7. –û—Ç–ª–∞–¥–æ—á–Ω–∞—è —Ç–µ–ª–µ–º–µ—Ç—Ä–∏—è
    outputTelemetry(joy_data, commands);
}
```

## üéÆ –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª–µ–∑–Ω–æ–π –Ω–∞–≥—Ä—É–∑–∫–æ–π

### –ö–∞–º–µ—Ä–∞
- **–ö–Ω–æ–ø–∫–∏:** BUTTON0 (–≤–ª–µ–≤–æ), BUTTON1 (–≤–ø—Ä–∞–≤–æ)
- **–¢–∏–ø:** –ò–Ω–∫—Ä–µ–º–µ–Ω—Ç–∞–ª—å–Ω–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ
- **–î–∏–∞–ø–∞–∑–æ–Ω:** 1000-2000 PWM
- **–°–∫–æ—Ä–æ—Å—Ç—å:** CAMERA_SPEED –µ–¥–∏–Ω–∏—Ü –∑–∞ CAMERA_UPDATE_INTERVAL –º—Å
- **–ë–µ–∑–æ–ø–∞—Å–Ω—ã–µ –ø—Ä–µ–¥–µ–ª—ã:** CAMERA_SAFE_MIN - CAMERA_SAFE_MAX

### –ú–∞–Ω–∏–ø—É–ª—è—Ç–æ—Ä
- **–ö–Ω–æ–ø–∫–∏:** BUTTON2 (–æ—Ç–∫—Ä—ã—Ç—å), BUTTON3 (–∑–∞–∫—Ä—ã—Ç—å)
- **–¢–∏–ø:** –ú–≥–Ω–æ–≤–µ–Ω–Ω–æ–µ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ
- **–°–æ—Å—Ç–æ—è–Ω–∏—è:** 
  - –û—Ç–∫—Ä—ã—Ç: PWM_MIN (1000)
  - –ó–∞–∫—Ä—ã—Ç: PWM_MAX (2000)

### –û—Å–≤–µ—â–µ–Ω–∏–µ
- **–ö–Ω–æ–ø–∫–∏:** BUTTON4 (–≤–∫–ª—é—á–∏—Ç—å), BUTTON5 (–≤—ã–∫–ª—é—á–∏—Ç—å)
- **–¢–∏–ø:** –ú–≥–Ω–æ–≤–µ–Ω–Ω–æ–µ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ
- **–°–æ—Å—Ç–æ—è–Ω–∏—è:**
  - –í—ã–∫–ª—é—á–µ–Ω–æ: PWM_MIN (1000)
  - –í–∫–ª—é—á–µ–Ω–æ: PWM_MAX (2000)

## üì° –§–æ—Ä–º–∞—Ç –ø–µ—Ä–µ–¥–∞—á–∏ –¥–∞–Ω–Ω—ã—Ö

### –ö–æ–º–∞–Ω–¥—ã –Ω–∞ ROV (Serial1)
```
motor0 motor1 motor2 motor3 motor4 motor5 motor6 motor7 camera manipulator light
1500   1500   1500   1500   1500   1500   1500   1500   1500  1000        0
```

### –û—Ç–ª–∞–¥–æ—á–Ω–∞—è —Ç–µ–ª–µ–º–µ—Ç—Ä–∏—è (Serial2)
```
J1X:0.5 J1Y:0.0 J2X:0.0 J2Y:0.0 PWM0:1500 PWM1:1500 PWM2:1500 PWM3:1500 CAM:1500 MAN:1000 LIGHT:0 B0:0 B1:0 B2:0 B3:0 B4:0 B5:0
```

## ‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∏ —Å–∏—Å—Ç–µ–º—ã

### –ö–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç—ã –¥–∂–æ–π—Å—Ç–∏–∫–æ–≤ (Config.h)
```cpp
struct JoystickCoefficients {
    float stick1_x = 0.5;    // –î–∂–æ–π—Å—Ç–∏–∫ 1 - X –æ—Å—å (–≤–ø–µ—Ä–µ–¥/–Ω–∞–∑–∞–¥)
    float stick1_y = 0.3;    // –î–∂–æ–π—Å—Ç–∏–∫ 1 - Y –æ—Å—å (–ø–æ–≤–æ—Ä–æ—Ç)
    float stick2_x = 0.75;   // –î–∂–æ–π—Å—Ç–∏–∫ 2 - X –æ—Å—å (–≤–µ—Ä—Ç–∏–∫–∞–ª—å–Ω–æ–µ –¥–≤–∏–∂–µ–Ω–∏–µ)
    float stick2_y = 1.0;    // –î–∂–æ–π—Å—Ç–∏–∫ 2 - Y –æ—Å—å (–Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è)
};
```

### –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –∫–∏–Ω–µ–º–∞—Ç–∏–∫–∏
```cpp
struct KinematicsConfig {
    int motor_count = 4;                    // –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –º–æ—Ç–æ—Ä–æ–≤
    bool reverse_motor[8] = {false, ...};   // –†–µ–≤–µ—Ä—Å –º–æ—Ç–æ—Ä–æ–≤
};
```

### –ù–∞—Å—Ç—Ä–æ–π–∫–∏ —Ñ–∏–ª—å—Ç—Ä–∞ –ö–∞–ª–º–∞–Ω–∞
```cpp
#define KALMAN_Q 25                  // –®—É–º –ø—Ä–æ—Ü–µ—Å—Å–∞ (—á—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –∫ –∏–∑–º–µ–Ω–µ–Ω–∏—è–º)
#define KALMAN_R 20                  // –®—É–º –∏–∑–º–µ—Ä–µ–Ω–∏–π (—Å–≥–ª–∞–∂–∏–≤–∞–Ω–∏–µ —à—É–º–∞)
#define KALMAN_P_INIT 1000           // –ù–∞—á–∞–ª—å–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –∫–æ–≤–∞—Ä–∏–∞—Ü–∏–∏
```

### –ù–∞—Å—Ç—Ä–æ–π–∫–∏ —Ç–∞–π–º–µ—Ä–æ–≤
```cpp
#define DATA_INTERVAL 50            // –ò–Ω—Ç–µ—Ä–≤–∞–ª –æ—Ç–ø—Ä–∞–≤–∫–∏ –¥–∞–Ω–Ω—ã—Ö (–º—Å)
#define LED_INTERVAL 200            // –ò–Ω—Ç–µ—Ä–≤–∞–ª –º–∏–≥–∞–Ω–∏—è —Å–≤–µ—Ç–æ–¥–∏–æ–¥–∞ (–º—Å)
#define CAMERA_UPDATE_INTERVAL 100  // –ò–Ω—Ç–µ—Ä–≤–∞–ª –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –∫–∞–º–µ—Ä—ã (–º—Å)
```

### –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –æ—Å–≤–µ—â–µ–Ω–∏—è
```cpp
#define LIGHT_OFF PWM_MIN   // –°–≤–µ—Ç –≤—ã–∫–ª—é—á–µ–Ω (1000)
#define LIGHT_ON PWM_MAX    // –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è —è—Ä–∫–æ—Å—Ç—å (2000)
```

## üîß –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ ROV

### –°—Ö–µ–º–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è
```
STM32F103C8T6          ROV Controller
‚îú‚îÄ‚îÄ Serial1 (PA9)  ‚Üí   RX (–∫–æ–º–∞–Ω–¥—ã)
‚îú‚îÄ‚îÄ Serial1 (PA10) ‚Üí   TX (–Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è)
‚îú‚îÄ‚îÄ LED (PC13)     ‚Üí   –ò–Ω–¥–∏–∫–∞—Ü–∏—è —Ä–∞–±–æ—Ç—ã
‚îî‚îÄ‚îÄ GND           ‚Üí   –û–±—â–∏–π –ø—Ä–æ–≤–æ–¥
```

### –ü—Ä–æ—Ç–æ–∫–æ–ª —Å–≤—è–∑–∏
- **–°–∫–æ—Ä–æ—Å—Ç—å:** 115200 baud
- **–§–æ—Ä–º–∞—Ç:** 8N1 (8 –±–∏—Ç –¥–∞–Ω–Ω—ã—Ö, –±–µ–∑ —á–µ—Ç–Ω–æ—Å—Ç–∏, 1 —Å—Ç–æ–ø-–±–∏—Ç)
- **–ò–Ω—Ç–µ—Ä–≤–∞–ª:** DATA_INTERVAL –º—Å –º–µ–∂–¥—É –∫–æ–º–∞–Ω–¥–∞–º–∏ (50 –º—Å)

## üöÄ –°–±–æ—Ä–∫–∞ –∏ –∑–∞–≥—Ä—É–∑–∫–∞

### –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è
- PlatformIO IDE
- STM32F103C8T6 (BluePill)
- ST-Link –ø—Ä–æ–≥—Ä–∞–º–º–∞—Ç–æ—Ä

### –ö–æ–º–∞–Ω–¥—ã
```bash
# –°–±–æ—Ä–∫–∞ –ø—Ä–æ–µ–∫—Ç–∞
pio run

# –ó–∞–≥—Ä—É–∑–∫–∞ –≤ –º–∏–∫—Ä–æ–∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä
pio run --target upload

# –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ Serial –ø–æ—Ä—Ç–∞
pio device monitor
```

## üìà –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

- **–ß–∞—Å—Ç–æ—Ç–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è:** ~20 –ì—Ü (50 –º—Å –∏–Ω—Ç–µ—Ä–≤–∞–ª)
- **–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ RAM:** ~7.7% (1580/20480 –±–∞–π—Ç)
- **–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ Flash:** ~32.7% (21412/65536 –±–∞–π—Ç)
- **–†–∞–∑—Ä–µ—à–µ–Ω–∏–µ ADC:** 12 –±–∏—Ç (0-4095)
- **–¢–æ—á–Ω–æ—Å—Ç—å PWM:** 1 –º–∫—Å
- **–ú–µ—Ä—Ç–≤–∞—è –∑–æ–Ω–∞ –¥–∂–æ–π—Å—Ç–∏–∫–æ–≤:** ¬±25 –µ–¥–∏–Ω–∏—Ü ADC

## üõ†Ô∏è –û—Ç–ª–∞–¥–∫–∞

### –ò–Ω–¥–∏–∫–∞—Ü–∏—è —Å–æ—Å—Ç–æ—è–Ω–∏—è
- **LED (PC13):** –ú–∏–≥–∞–µ—Ç –∫–∞–∂–¥—ã–µ 200 –º—Å (LED_INTERVAL)
- **Serial2:** –û—Ç–ª–∞–¥–æ—á–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –ø—Ä–∏ –≤–∫–ª—é—á–µ–Ω–Ω–æ–º DEBUG_TELEMETRY
- **–°–∏—Å—Ç–µ–º–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è:** –í—ã–≤–æ–¥–∏—Ç—Å—è –ø—Ä–∏ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ —Å –æ–ø–∏—Å–∞–Ω–∏–µ–º –≤—Å–µ—Ö –Ω–∞—Å—Ç—Ä–æ–µ–∫

### –¢–∏–ø–∏—á–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã
1. **–î–∂–æ–π—Å—Ç–∏–∫–∏ –Ω–µ –∫–∞–ª–∏–±—Ä—É—é—Ç—Å—è** - –ø—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ ADC –ø–∏–Ω–æ–≤
2. **–ö–Ω–æ–ø–∫–∏ –Ω–µ —Ä–∞–±–æ—Ç–∞—é—Ç** - –ø—Ä–æ–≤–µ—Ä—å—Ç–µ INPUT_PULLUP –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
3. **–ù–µ—Ç —Å–≤—è–∑–∏ —Å ROV** - –ø—Ä–æ–≤–µ—Ä—å—Ç–µ Serial1 –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∏ —Å–∫–æ—Ä–æ—Å—Ç—å
4. **–ù–µ—Å—Ç–∞–±–∏–ª—å–Ω–∞—è —Ä–∞–±–æ—Ç–∞** - –ø—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–∏—Ç–∞–Ω–∏–µ –∏ –∑–∞–∑–µ–º–ª–µ–Ω–∏–µ
5. **–°–ª–∏—à–∫–æ–º —Ä–µ–∑–∫–∏–µ –¥–≤–∏–∂–µ–Ω–∏—è** - —É–≤–µ–ª–∏—á—å—Ç–µ KALMAN_R –¥–ª—è –±–æ–ª—å—à–µ–≥–æ —Å–≥–ª–∞–∂–∏–≤–∞–Ω–∏—è
6. **–ú–µ–¥–ª–µ–Ω–Ω–∞—è —Ä–µ–∞–∫—Ü–∏—è** - —É–º–µ–Ω—å—à–∏—Ç–µ KALMAN_R –∏–ª–∏ —É–≤–µ–ª–∏—á—å—Ç–µ KALMAN_Q

## üîß –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

### –§–∏–ª—å—Ç—Ä –ö–∞–ª–º–∞–Ω–∞
- **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Å–≥–ª–∞–∂–∏–≤–∞–Ω–∏–µ** —Å–∏–≥–Ω–∞–ª–æ–≤ –¥–∂–æ–π—Å—Ç–∏–∫–æ–≤
- **–ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã** Q, R, P_init –¥–ª—è —Ç–æ–Ω–∫–æ–π –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
- **–í–∞–ª–∏–¥–∞—Ü–∏—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏** —Å –ø—Ä–æ–≤–µ—Ä–∫–æ–π –¥–∏–∞–ø–∞–∑–æ–Ω–æ–≤ –∑–Ω–∞—á–µ–Ω–∏–π

### –í–∞–ª–∏–¥–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö
- **–ü—Ä–æ–≤–µ—Ä–∫–∞ ADC –∑–Ω–∞—á–µ–Ω–∏–π** (0-4095)
- **–ü—Ä–æ–≤–µ—Ä–∫–∞ PWM –∑–Ω–∞—á–µ–Ω–∏–π** (1000-2000)
- **–í–∞–ª–∏–¥–∞—Ü–∏—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏** –∫–∏–Ω–µ–º–∞—Ç–∏–∫–∏ –∏ —Ñ–∏–ª—å—Ç—Ä–∞ –ö–∞–ª–º–∞–Ω–∞
- **–ë–µ–∑–æ–ø–∞—Å–Ω—ã–µ –ø—Ä–µ–¥–µ–ª—ã** –¥–ª—è –∫–∞–º–µ—Ä—ã –∏ –º–∞–Ω–∏–ø—É–ª—è—Ç–æ—Ä–∞

### –ì–∏–±–∫–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
- **–ü–æ–¥–¥–µ—Ä–∂–∫–∞ 3, 4, 6, 8 –º–æ—Ç–æ—Ä–æ–≤** —Å —Ä–∞–∑–ª–∏—á–Ω—ã–º–∏ —Å—Ö–µ–º–∞–º–∏ –∫–∏–Ω–µ–º–∞—Ç–∏–∫–∏
- **–†–µ–≤–µ—Ä—Å –º–æ—Ç–æ—Ä–æ–≤** –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –¥–≤–∏–∂–∏—Ç–µ–ª—è –æ—Ç–¥–µ–ª—å–Ω–æ
- **–ö–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç—ã –≤–∫–ª–∞–¥–∞** –¥–ª—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ —á—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –æ—Å–µ–π
- **–ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º—ã–µ –∏–Ω—Ç–µ—Ä–≤–∞–ª—ã** –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Ä–∞–∑–ª–∏—á–Ω—ã—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤
- **–ï–¥–∏–Ω–æ–æ–±—Ä–∞–∑–Ω–∞—è –ª–æ–≥–∏–∫–∞** —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø–æ–ª–µ–∑–Ω–æ–π –Ω–∞–≥—Ä—É–∑–∫–æ–π (–º–∞–Ω–∏–ø—É–ª—è—Ç–æ—Ä –∏ —Å–≤–µ—Ç–∏–ª—å–Ω–∏–∫ —Ä–∞–±–æ—Ç–∞—é—Ç –æ–¥–∏–Ω–∞–∫–æ–≤–æ)

## üìù –õ–∏—Ü–µ–Ω–∑–∏—è

–ü—Ä–æ–µ–∫—Ç —Ä–∞–∑—Ä–∞–±–æ—Ç–∞–Ω –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è ROV –∏ –º–æ–∂–µ—Ç –±—ã—Ç—å —Å–≤–æ–±–æ–¥–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω –∏ –º–æ–¥–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω.
